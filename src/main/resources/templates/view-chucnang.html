<html xmlns:th="http://www.thymeleaf.org" lang="en"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity5">
<head th:replace="layout :: head">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>CHỨC NĂNG</title>
<link rel="stylesheet"
	href="https://fonts.googleapis.com/css?family=Roboto|Varela+Round">
<link rel="stylesheet"
	href="https://fonts.googleapis.com/icon?family=Material+Icons">
<link rel="stylesheet"
	href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet"
	href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script type="text/javascript"
	src="webjars/bootstrap/4.0.0-alpha.2/js/bootstrap.min.js"></script>
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script
	src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
<script
	src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script type="text/javascript" src="webjars/jquery/2.2.3/jquery.min.js"></script>
<script type="text/javascript">
	$(document).ready(function() {
		var urls = "/admin/chucnang/ #myModals";
		$('#model-body').html(event).load(urls);
		$('#bnn').on('click', function(event) {
			event.preventDefault();
			$('#myModal').modal("hide");
		});

		$('.buttonDelete').on('click', function(event) {
			event.preventDefault();
			$('#myDelete').modal();
			$('#delRef').click(function() {
				$('#formDelete').submit();
			});

		});

		$('.edit').on('click', function(event) {
			event.preventDefault();
			$('#myEdit').modal("hide");

		});

		$('.chi').on('click', function(event) {
			event.preventDefault();
			$('#myChitiet').modal("hide");

		});
	});
</script>



</head>
<body class="hold-transition skin-blue fixed sidebar-mini fuelux">
	<div class="wrapper">
		<header th:replace="layout :: header"></header>
		<aside th:replace="layout :: aside"></aside>
		<div class="content-wrapper">

			<section class="content-header">
				<h1>TRANG CHỨC NĂNG</h1>
			</section>
			<!-- Content Header (Page header) -->
			<!-- Main content -->

			<!-- /.content -->
			<div class="container main-content form">
				<div class="row">
					<h2 class="myclass">Danh sách chức năng</h2>
					<hr>
					<a sec:authorize="hasAnyRole('ROLE_ADMIN','ROLE_STM_EMPLOYEE')" 
					th:href="@{/admin/chucnang/}"
						class="btn btn-primary pull-left"> <span
						class="glyphicon glyphicon-plus"></span>
					</a>
					<!-- <a sec:authorize="hasAnyRole('ROLE_ADMIN','ROLE_STM_EMPLOYEE')" 
					th:href="@{/admin/chucnang/delete/'+ ${chucnang.id}}" class="btn btn-primary buttonDelete">
						<i class="glyphicon glyphicon-trash"></i>
					</a> -->
					<!-- The Modal Add New-->
					<div class="modal" id="myModal">
						<div class="modal-dialog">
							<div class="modal-content">
								<!-- Modal Header -->
								<div id="model-body"></div>
								<div class="modal-footer"></div>
							</div>
						</div>
					</div>


					<form th:action="@{/admin/chucnang/dataSearch}" id="dataSearch"
						class="form-inline pull-right">
						<input type="text" class="form-control" name="keyword"
							th:value="${session.KEYWORD}" placeholder="Tìm kiếm theo tên chức năng...">
						<button type="submit" class="btn btn-primary" id="search">Tìm
							kiếm</button>

					</form>
					<th:block th:if="${#lists.isEmpty(CHUCNANGS.pageList)}">
						<h2>Không tìm thấy chức năng</h2>
					</th:block>



					<th:block th:unless="${#lists.isEmpty(CHUCNANGS.pageList)}">

						<div class="row">
							<form th:action="@{/admin/chucnang/del}" id="formDelete">
								<button class="btn btn-primary buttonDelete">
											<span
												class="glyphicon glyphicon-trash"></span>
										</button>
								<table class="table table-bordered">
									<thead>
										<tr>
											<th>Chọn</th>
											<th>Id</th>
											<th>Mã chức năng</th>
											<th>Tên chức năng</th>
											<th>Mã nguồn</th>
											<th>Xóa</th>
											<th>Sửa</th>
											<th>Xem</th>
										</tr>
									</thead>
									<tbody>
										<tr th:each="chucnang: ${CHUCNANGS.pageList}">
											<td><input type="checkbox" id="allDelete" name="lcn"
												th:value="${chucnang.id}" /></td>
											<td th:text="${chucnang.id}"></td>
											<td th:text="${chucnang.machucnang}"></td>
											<td th:text="${chucnang.tenchucnang}"></td>
											<td th:text="${chucnang.maapi}"></td>

											<!-- class="btn btn-primary edit" -->
											<td sec:authorize="hasAnyRole('ROLE_ADMIN', 'ROLE_STM_EMPLOYEE')"><a
											th:href="@{'/admin/chucnang/delete/' + ${chucnang.id}}"><span
												class="glyphicon glyphicon-trash"></span></a></td>
											<td sec:authorize="hasAnyRole('ROLE_ADMIN', 'ROLE_STM_EMPLOYEE')"><a
											th:href="@{'/admin/chucnang/edit/' + ${chucnang.id}}"><span
												class="glyphicon glyphicon-pencil"></span></a></td>
											<td><a th:href="@{/admin/chucnang/chucnang-chitiet/}"
												data-toggle="modal" data-target="#myChitiet"
												th:attrappend="data-target=${chucnang.id}"><span
													class="glyphicon glyphicon-eye-open"></span>
												<!-- <i
													class="fas fa-eye"></i> --></a> <!-- The Modal Chi tiet -->
												<div class="modal" id="myChitiet"
													th:attrappend="id=${chucnang.id}">
													<div class="modal-dialog">
														<div class="modal-content chitiet">

															<!-- Modal Header -->
															<div class="modal-header">
																<h4>Chi tiết</h4>
																<button type="button" class="close" data-dismiss="modal">&times;</button>
															</div>
															<div id="chitiet-body">
																<table class="table table-bordered">
																	<tr>
																		<th>Id</th>
																		<td th:text="${chucnang.id}"></td>
																	</tr>
																	<tr>
																		<th>Mã Chức Năng</th>
																		<td th:text="${chucnang.machucnang}"></td>
																	</tr>
																	<tr>
																		<th>Tên Chức Năng</th>
																		<td th:text="${chucnang.tenchucnang}"></td>
																	</tr>
																	<tr>
																		<th>Mã Nguồn</th>
																		<td th:text="${chucnang.maapi}"></td>
																	</tr>
																	<tr>
																		<th>Ngày tạo</th>
																		<td th:text="${chucnang.createday}"></td>
																	</tr>
																	<tr>
																		<th>Người tạo</th>
																		<td th:text="${chucnang.nguoitao}"></td>
																	</tr>
																	<tr>
																		<th>Ngày Cập Nhật</th>
																		<td th:text="${chucnang.updateday}"></td>
																	</tr>
																	<tr>
																		<th>Người Cập Nhật</th>
																		<td th:text="${chucnang.nguoiupdate}"></td>
																	</tr>
																	<tr>
																		<th>Mã Mục cha</th>
																		<td th:text="${chucnang.parentid}"></td>
																	</tr>

																</table>
															</div>
															<div class="modal-footer"></div>
														</div>
													</div>
												</div></td>

										</tr>
									</tbody>
								</table>
							</form>
						</div>

						<p class="showcount" th:text="'Số lượng: ' + ${sum}"></p>
						<p class="showin"
							th:text="'Trang '+ ${pageNumber} + ' trong tổng số ' + ${totalPageCount} + ' trang' "></p>

						<!-- phan trang-->
						<ul class="pagination">
							<li
								th:class="${currentIndex == 1} ? 'page-item disabled' : 'page-item'">
								<a class="page-link" th:href="@{/chucnang/list}">Đầu</a>
							</li>
							<li
								th:class="${currentIndex == 1} ? 'page-item disabled' : 'page-item'">
								<a class="page-link" aria-label="Previous"
								th:href="@{|${baseUrl}${currentIndex - 1}|}"
								title='Go to previous page'> <span aria-hidden="true"><<</span>
									<span class="sr-only">Lùi</span></a>
							</li>
							<li th:each="item: ${#numbers.sequence(beginIndex, endIndex)}"
								th:class="${item == currentIndex ? 'page-item active' : 'page-item'}">
								<a class="page-link" th:href="@{|${baseUrl}${item}|}">
									<span th:text='${item}'>1</span>
							</a>
							</li>
							<li
								th:class="${currentIndex == totalPageCount} ? 'page-item disabled' : 'page-item'">
								<a class="page-link" aria-label="Next"
								th:href="@{|${baseUrl}${currentIndex + 1}|}"
								title='Go to next page'> <span aria-hidden="true">>></span>
									<span class="sr-only">Tiến</span></a>
							</li>
							<li
								th:class="${currentIndex == totalPageCount} ? 'page-item disabled' : 'page-item'">
								<a class="page-link"
								th:href="@{|${baseUrl}${totalPageCount}|}">Cuối</a>
							</li>
						</ul>

					</th:block>

					<!-- The Modal Delete -->
					<div class="modal" tabindex="-1" role="dialog" id="myDelete">
						<div class="modal-dialog">
							<div class="modal-content">

								<!-- Modal Header -->
								<div class="modal-header">

									<button type="button" class="close" data-dismiss="modal"
										aria-label="Close">
										<span aria-hidden="true">&times;</span>
									</button>
								</div>
								<div id="delete-body">
									<h4>Bạn có chắc chắn răng muốn xóa thông tin này?</h4>


								</div>
								<div class="modal-footer">
									<button type="button" id="delRef" class="btn btn-primary ">Đúng,
										Xóa thông tin này</button>
									<button type="button" class="btn btn-danger"
										data-dismiss="modal">Đóng</button>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>

		</div>
	</div>
	<footer th:replace="layout :: footer"></footer>
</body>


</html>